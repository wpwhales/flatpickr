{"version":3,"file":"scrollPlugin.js","sources":["../../src/utils/dom.ts","../../src/plugins/scrollPlugin.ts"],"sourcesContent":["export function toggleClass(\n  elem: HTMLElement,\n  className: string,\n  bool: boolean\n) {\n  if (bool === true) return elem.classList.add(className);\n  elem.classList.remove(className);\n}\n\nexport function createElement<T extends HTMLElement>(\n  tag: keyof HTMLElementTagNameMap,\n  className: string,\n  content?: string\n): T {\n  const e = window.document.createElement(tag) as T;\n  className = className || \"\";\n  content = content || \"\";\n\n  e.className = className;\n\n  if (content !== undefined) e.textContent = content;\n\n  return e;\n}\n\nexport function clearNode(node: HTMLElement) {\n  while (node.firstChild) node.removeChild(node.firstChild);\n}\n\nexport function findParent(\n  node: Element,\n  condition: (n: Element) => boolean\n): Element | undefined {\n  if (condition(node)) return node;\n  else if (node.parentNode)\n    return findParent(node.parentNode as Element, condition);\n\n  return undefined; // nothing found\n}\n\nexport function createNumberInput(\n  inputClassName: string,\n  opts?: Record<string, any>\n) {\n  const wrapper = createElement<HTMLDivElement>(\"div\", \"numInputWrapper\"),\n    numInput = createElement<HTMLInputElement>(\n      \"input\",\n      \"numInput \" + inputClassName\n    ),\n    arrowUp = createElement<HTMLSpanElement>(\"span\", \"arrowUp\"),\n    arrowDown = createElement<HTMLSpanElement>(\"span\", \"arrowDown\");\n\n  if (navigator.userAgent.indexOf(\"MSIE 9.0\") === -1) {\n    numInput.type = \"number\";\n  } else {\n    numInput.type = \"text\";\n    numInput.pattern = \"\\\\d*\";\n  }\n\n  if (opts !== undefined)\n    for (const key in opts) numInput.setAttribute(key, opts[key]);\n\n  wrapper.appendChild(numInput);\n  wrapper.appendChild(arrowUp);\n  wrapper.appendChild(arrowDown);\n\n  return wrapper;\n}\n\nexport function getEventTarget(event: Event): EventTarget | null {\n  try {\n    if (typeof event.composedPath === \"function\") {\n      const path = event.composedPath();\n      return path[0];\n    }\n    return event.target;\n  } catch (error) {\n    return event.target;\n  }\n}\n","import { Plugin } from \"../types/options\";\nimport { Instance } from \"../types/instance\";\nimport { getEventTarget } from \"../utils/dom\";\n\nif (typeof window.CustomEvent !== \"function\") {\n  const CustomEvent = function (\n    typeArg: string,\n    eventInitDict?: CustomEventInit\n  ): CustomEvent {\n    eventInitDict = eventInitDict || {\n      bubbles: false,\n      cancelable: false,\n      detail: undefined,\n    };\n    const evt = document.createEvent(\"CustomEvent\");\n    evt.initCustomEvent(\n      typeArg,\n      eventInitDict.bubbles as boolean,\n      eventInitDict.cancelable as boolean,\n      eventInitDict.detail\n    );\n    return evt;\n  };\n\n  CustomEvent.prototype = window.Event.prototype;\n\n  window.CustomEvent = <any>CustomEvent;\n}\n\nfunction delta(e: WheelEvent) {\n  return Math.max(-1, Math.min(1, (e as any).wheelDelta || -e.deltaY));\n}\n\nconst scroll = (e: WheelEvent) => {\n  e.preventDefault();\n  const ev = new CustomEvent(\"increment\", {\n    bubbles: true,\n  });\n  (ev as any).delta = delta(e);\n  (getEventTarget(e) as HTMLInputElement).dispatchEvent(ev);\n};\n\nfunction scrollMonth(fp: Instance) {\n  return (e: WheelEvent) => {\n    e.preventDefault();\n    const mDelta = delta(e);\n    fp.changeMonth(mDelta);\n  };\n}\n\nfunction scrollPlugin(): Plugin {\n  return function (fp) {\n    const monthScroller = scrollMonth(fp);\n    return {\n      onReady() {\n        if (fp.timeContainer) {\n          fp.timeContainer.addEventListener(\"wheel\", scroll);\n        }\n\n        if (fp.yearElements) {\n          fp.yearElements.forEach((yearElem) =>\n            yearElem.addEventListener(\"wheel\", scroll)\n          );\n        }\n\n        if (fp.monthElements) {\n          fp.monthElements.forEach((monthElem) =>\n            monthElem.addEventListener(\"wheel\", monthScroller)\n          );\n        }\n\n        fp.loadedPlugins.push(\"scroll\");\n      },\n      onDestroy() {\n        if (fp.timeContainer) {\n          fp.timeContainer.removeEventListener(\"wheel\", scroll);\n        }\n\n        if (fp.yearElements) {\n          fp.yearElements.forEach((yearElem) =>\n            yearElem.removeEventListener(\"wheel\", scroll)\n          );\n        }\n\n        if (fp.monthElements) {\n          fp.monthElements.forEach((monthElem) =>\n            monthElem.removeEventListener(\"wheel\", monthScroller)\n          );\n        }\n      },\n    };\n  };\n}\n\nexport default scrollPlugin;\n"],"names":[],"mappings":"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"}