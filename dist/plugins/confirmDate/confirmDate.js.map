{"version":3,"file":"confirmDate.js","sources":["../../../src/utils/dom.ts","../../../src/plugins/confirmDate/confirmDate.ts"],"sourcesContent":["export function toggleClass(\n  elem: HTMLElement,\n  className: string,\n  bool: boolean\n) {\n  if (bool === true) return elem.classList.add(className);\n  elem.classList.remove(className);\n}\n\nexport function createElement<T extends HTMLElement>(\n  tag: keyof HTMLElementTagNameMap,\n  className: string,\n  content?: string\n): T {\n  const e = window.document.createElement(tag) as T;\n  className = className || \"\";\n  content = content || \"\";\n\n  e.className = className;\n\n  if (content !== undefined) e.textContent = content;\n\n  return e;\n}\n\nexport function clearNode(node: HTMLElement) {\n  while (node.firstChild) node.removeChild(node.firstChild);\n}\n\nexport function findParent(\n  node: Element,\n  condition: (n: Element) => boolean\n): Element | undefined {\n  if (condition(node)) return node;\n  else if (node.parentNode)\n    return findParent(node.parentNode as Element, condition);\n\n  return undefined; // nothing found\n}\n\nexport function createNumberInput(\n  inputClassName: string,\n  opts?: Record<string, any>\n) {\n  const wrapper = createElement<HTMLDivElement>(\"div\", \"numInputWrapper\"),\n    numInput = createElement<HTMLInputElement>(\n      \"input\",\n      \"numInput \" + inputClassName\n    ),\n    arrowUp = createElement<HTMLSpanElement>(\"span\", \"arrowUp\"),\n    arrowDown = createElement<HTMLSpanElement>(\"span\", \"arrowDown\");\n\n  if (navigator.userAgent.indexOf(\"MSIE 9.0\") === -1) {\n    numInput.type = \"number\";\n  } else {\n    numInput.type = \"text\";\n    numInput.pattern = \"\\\\d*\";\n  }\n\n  if (opts !== undefined)\n    for (const key in opts) numInput.setAttribute(key, opts[key]);\n\n  wrapper.appendChild(numInput);\n  wrapper.appendChild(arrowUp);\n  wrapper.appendChild(arrowDown);\n\n  return wrapper;\n}\n\nexport function getEventTarget(event: Event): EventTarget | null {\n  try {\n    if (typeof event.composedPath === \"function\") {\n      const path = event.composedPath();\n      return path[0];\n    }\n    return event.target;\n  } catch (error) {\n    return event.target;\n  }\n}\n","import { Instance } from \"../../types/instance\";\nimport { Plugin } from \"../../types/options\";\nimport { getEventTarget } from \"../../utils/dom\";\n\nexport interface Config {\n  confirmIcon?: string;\n  confirmText?: string;\n  showAlways?: boolean;\n  theme?: string;\n}\n\nconst defaultConfig: Config = {\n  confirmIcon:\n    \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='17' height='17' viewBox='0 0 17 17'> <g> </g> <path d='M15.418 1.774l-8.833 13.485-4.918-4.386 0.666-0.746 4.051 3.614 8.198-12.515 0.836 0.548z' fill='#000000' /> </svg>\",\n  confirmText: \"OK \",\n  showAlways: false,\n  theme: \"light\",\n};\n\nfunction confirmDatePlugin(pluginConfig: Config): Plugin {\n  const config = { ...defaultConfig, ...pluginConfig };\n  let confirmContainer: HTMLDivElement;\n  const confirmButtonCSSClass = \"flatpickr-confirm\";\n\n  return function (fp: Instance) {\n    if (fp.config.noCalendar || fp.isMobile) return {};\n    return {\n      onKeyDown(_: Date[], __: string, ___: Instance, e: KeyboardEvent) {\n        const eventTarget = getEventTarget(e);\n        const isTargetLastFocusableElement =\n          (!fp.config.time_24hr && eventTarget === fp.amPM) ||\n          (fp.config.time_24hr &&\n            ((fp.config.enableSeconds && eventTarget === fp.secondElement) ||\n              (!fp.config.enableSeconds && eventTarget === fp.minuteElement)));\n        if (\n          fp.config.enableTime &&\n          e.key === \"Tab\" &&\n          isTargetLastFocusableElement\n        ) {\n          e.preventDefault();\n          confirmContainer.focus();\n        } else if (e.key === \"Enter\" && eventTarget === confirmContainer)\n          fp.close();\n      },\n\n      onReady() {\n        confirmContainer = fp._createElement<HTMLDivElement>(\n          \"div\",\n          `${confirmButtonCSSClass} ${config.showAlways ? \"visible\" : \"\"} ${\n            config.theme\n          }Theme`,\n          config.confirmText\n        );\n\n        confirmContainer.tabIndex = -1;\n        confirmContainer.innerHTML += config.confirmIcon;\n\n        confirmContainer.addEventListener(\"click\", fp.close);\n        fp.calendarContainer.appendChild(confirmContainer);\n\n        fp.loadedPlugins.push(\"confirmDate\");\n      },\n      ...(!config.showAlways\n        ? {\n            onChange: function (_: Date[], dateStr: string) {\n              const showCondition =\n                fp.config.enableTime ||\n                fp.config.mode === \"multiple\" ||\n                fp.loadedPlugins.indexOf(\"monthSelect\") !== -1;\n\n              const localConfirmContainer = fp.calendarContainer.querySelector(\n                `.${confirmButtonCSSClass}`\n              );\n\n              if (!localConfirmContainer) return;\n\n              if (\n                dateStr &&\n                !fp.config.inline &&\n                showCondition &&\n                localConfirmContainer\n              )\n                return localConfirmContainer.classList.add(\"visible\");\n\n              localConfirmContainer.classList.remove(\"visible\");\n            },\n          }\n        : {}),\n    };\n  };\n}\n\nexport default confirmDatePlugin;\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;aAqEgB,cAAc,CAAC,KAAY;QACzC,IAAI;YACF,IAAI,OAAO,KAAK,CAAC,YAAY,KAAK,UAAU,EAAE;gBAC5C,IAAM,IAAI,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC;gBAClC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;aAChB;YACD,OAAO,KAAK,CAAC,MAAM,CAAC;SACrB;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,KAAK,CAAC,MAAM,CAAC;SACrB;IACH;;ICpEA,IAAM,aAAa,GAAW;QAC5B,WAAW,EACT,oRAAoR;QACtR,WAAW,EAAE,KAAK;QAClB,UAAU,EAAE,KAAK;QACjB,KAAK,EAAE,OAAO;KACf,CAAC;IAEF,SAAS,iBAAiB,CAAC,YAAoB;QAC7C,IAAM,MAAM,yBAAQ,aAAa,GAAK,YAAY,CAAE,CAAC;QACrD,IAAI,gBAAgC,CAAC;QACrC,IAAM,qBAAqB,GAAG,mBAAmB,CAAC;QAElD,OAAO,UAAU,EAAY;YAC3B,IAAI,EAAE,CAAC,MAAM,CAAC,UAAU,IAAI,EAAE,CAAC,QAAQ;gBAAE,OAAO,EAAE,CAAC;YACnD,kBACE,SAAS,EAAT,UAAU,CAAS,EAAE,EAAU,EAAE,GAAa,EAAE,CAAgB;oBAC9D,IAAM,WAAW,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC;oBACtC,IAAM,4BAA4B,GAChC,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,SAAS,IAAI,WAAW,KAAK,EAAE,CAAC,IAAI;yBAC/C,EAAE,CAAC,MAAM,CAAC,SAAS;6BACjB,CAAC,EAAE,CAAC,MAAM,CAAC,aAAa,IAAI,WAAW,KAAK,EAAE,CAAC,aAAa;iCAC1D,CAAC,EAAE,CAAC,MAAM,CAAC,aAAa,IAAI,WAAW,KAAK,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;oBACvE,IACE,EAAE,CAAC,MAAM,CAAC,UAAU;wBACpB,CAAC,CAAC,GAAG,KAAK,KAAK;wBACf,4BAA4B,EAC5B;wBACA,CAAC,CAAC,cAAc,EAAE,CAAC;wBACnB,gBAAgB,CAAC,KAAK,EAAE,CAAC;qBAC1B;yBAAM,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,IAAI,WAAW,KAAK,gBAAgB;wBAC9D,EAAE,CAAC,KAAK,EAAE,CAAC;iBACd;gBAED,OAAO,EAAP;oBACE,gBAAgB,GAAG,EAAE,CAAC,cAAc,CAClC,KAAK,EACF,qBAAqB,UAAI,MAAM,CAAC,UAAU,GAAG,SAAS,GAAG,EAAE,UAC5D,MAAM,CAAC,KAAK,UACP,EACP,MAAM,CAAC,WAAW,CACnB,CAAC;oBAEF,gBAAgB,CAAC,QAAQ,GAAG,CAAC,CAAC,CAAC;oBAC/B,gBAAgB,CAAC,SAAS,IAAI,MAAM,CAAC,WAAW,CAAC;oBAEjD,gBAAgB,CAAC,gBAAgB,CAAC,OAAO,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;oBACrD,EAAE,CAAC,iBAAiB,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;oBAEnD,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;iBACtC,KACG,CAAC,MAAM,CAAC,UAAU;kBAClB;oBACE,QAAQ,EAAE,UAAU,CAAS,EAAE,OAAe;wBAC5C,IAAM,aAAa,GACjB,EAAE,CAAC,MAAM,CAAC,UAAU;4BACpB,EAAE,CAAC,MAAM,CAAC,IAAI,KAAK,UAAU;4BAC7B,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;wBAEjD,IAAM,qBAAqB,GAAG,EAAE,CAAC,iBAAiB,CAAC,aAAa,CAC9D,MAAI,qBAAuB,CAC5B,CAAC;wBAEF,IAAI,CAAC,qBAAqB;4BAAE,OAAO;wBAEnC,IACE,OAAO;4BACP,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM;4BACjB,aAAa;4BACb,qBAAqB;4BAErB,OAAO,qBAAqB,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;wBAExD,qBAAqB,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;qBACnD;iBACF;kBACD,EAAE,GACN;SACH,CAAC;IACJ;;;;;;;;"}